<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="topic7148cips">
        <title>HP Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 2.1 Alpha: Prerequisites -
                Preparing the Installation Environment  for the Sacramento Deployment</title>
        <titlealts>
                <searchtitle>HP Helion OpenStack Carrier Grade Installation
                        Prerequisites</searchtitle>
        </titlealts>
        <prolog>
                <metadata>
                        <othermeta name="layout" content="default"/>
                        <othermeta name="product-version"
                                content="HP Helion OpenStack Carrier Grade 2.0"/>
                        <othermeta name="role" content="Storage Administrator"/>
                        <othermeta name="role" content="Storage Architect"/>
                        <othermeta name="role" content="Michael B"/>
                        <othermeta name="product-version1"
                                content="HP Helion OpenStack Carrier Grade 2.0"/>
                </metadata>
        </prolog>
        <body>
               <bodydiv id="prereqs">
                <p>This document describes the prerequisite steps required to install HP Helion
                        OpenStack Carrier Grade in a baremetal environment.</p>
                <section id="hardware">
                        <title>Hardware and software requirements</title>
                        <p>Before you start, if you have not done so already, make sure your
                                environment meets the hardware and software requirements. See the
                                        <xref href="../carrier-grade-support-matrix2.dita#topic1773cgsm2">HP
                                        Helion OpenStack Support Matrix</xref>.</p>
                </section>
                <section id="kvm">
                        <title>Preparing the lifecycle manager host</title>
                        <p>Perform the following tasks on the lifecycle manager host:</p>
                        <ul>
                                <li><?oxy_insert_start author="burkmich" timestamp="20150727T182851-0400"?><xref
                                                href="#topic7148cips/proxy" format="dita"
                                        /><?oxy_insert_end?></li>
                                <li><?oxy_insert_start author="burkmich" timestamp="20150727T183030-0400"?><xref
                                                href="#topic7148cips/packages" format="dita"
                                        /><?oxy_insert_end?></li>
                                <li><?oxy_insert_start author="burkmich" timestamp="20150727T183112-0400"?><xref
                                                href="#topic7148cips/configure-the-xrdp-remote-desktop-display"
                                                format="dita"/><?oxy_insert_end?></li>
                                <li><?oxy_insert_start author="burkmich" timestamp="20150727T183118-0400"?><xref
                                                href="#topic7148cips/ntp" format="dita"
                                        /><?oxy_insert_end?></li>
                                <li><xref href="#topic7148cips/ssh" format="dita"/></li>
                                <li><xref href="#topic7148cips/network" format="dita"/></li>
                                <li><xref href="#topic7148cips/ldap" format="dita"/></li>
                                <li><xref href="#topic7148cips/vsd" format="dita"/></li>
                                <li><xref href="#topic7148cips/prepbare" format="dita"/></li>
                        </ul>
                        <title>Install Ubuntu Server 14.04.2 LTS</title>
                        <p>The lifecycle manager host must have Ubuntu Server 14.04.2 LTS installed
                                        before performing the HP Helion OpenStack Carrier Grade
                                        installation.</p>
                </section>
                <!--<section id="pub-key"> <title>Obtain a public key</title>
<p>On the lifecycle manager host, the user <codeph>root</codeph> must have a public key.</p>
<ol>
<li>Launch a terminal and log in to your lifecycle manager host as root:<p>sudo su -</p></li>
<li>Use the following command to create the key. Accept the default
          values.<p>/root/.ssh/id_rsa</p></li>
<li>Install the public key into the authorized keys on the KVM
            Host:<codeblock><codeph>ssh-copy-id &lt;IP_address&gt;
</codeph></codeblock><p>Enter the
            IP address of the default network gateway on the lifecycle manager host.</p></li>
</ol>
</section>
-->
                <section id="proxy">
                        <title>Configure proxy information</title>
                        <p>Before you begin your installation on the lifecycle manager host,
                                        configure the proxy information for your environment using
                                        the following steps:</p>
                        <ol>
                                <li>Launch a terminal and log in to your lifecycle manager host as
                                                root:<codeblock><codeph>sudo su -
</codeph></codeblock></li>
                                <li>Edit the <codeph>/etc/environment</codeph> file to add the
                                                following lines, using values specific to your
                                                environment. <p><b>Note:</b> The <codeph>export
                                                  no-proxy</codeph> command is
                                                  optional<!-- per Lakshmi email 10/9/15-->:</p><codeblock><codeph>vsc_config_restore.yml ATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games"
export http_proxy=http://&lt;web_proxy_IP&gt;/
export https_proxy=http://&lt;web_proxy_IP&gt;/
export no_proxy=localhost,127.0.0.1,&lt;IP_address>,&lt;provider_network></codeph></codeblock><p>Where:</p><codeblock>&lt;web_proxy_IP> is your web proxy IP address.
&lt;IP_address> is the IP address of the lifecycle manager host</codeblock></li>
                                <li>Source the <codeph>environment</codeph>
                                        file:<codeblock><codeph>source /etc/environment
</codeph></codeblock></li>
                        </ol>
                </section>
                <section id="packages">
                        <title>Install Ubuntu packages</title>
                        <p>Before starting the installation, you must install the following packages
                                        on the lifecycle manager host.</p>
                        <ul id="ul_szw_sh4_rs">
                                <li>ntp </li>
                                <li>firefox </li>
                                <li>gedit </li>
                                <li>xrdp </li>
                                <li>xfce4 </li>
                                <li>qemu-kvm </li>
                                <li>libvirt-bin </li>
                                <li>python-libvirt </li>
                                <li>qemu-system-x86 </li>
                                <li>libssl-dev </li>
                                <li>libffi-dev </li>
                                <li>git </li>
                                <li>python-virtualenv </li>
                                <li>python-dev </li>
                                <li>virt-manager</li>
                                <li>xorg</li>
                                <li>gnome-core </li>
                                <li>gnome-system-tools</li>
                                <li>gnome-app-install </li>
                                <li>sshpass</li>
                                <li>gnupg</li>
                                <li>jq</li>
                                <li>vlan</li>
                                <li>sudo</li>
                                <li>ansible</li>
                        </ul>
                        <p>To install the packages on the lifecycle manager host:</p>
                        <ol>
                                <li>On the KLM host, run the following command to install all
                                                required packages:
                                                <codeblock><codeph>sudo su -l -c "apt-get install -y ntp firefox gedit xrdp xfce4 qemu-kvm libvirt-bin python-libvirt qemu-system-x86 libssl-dev libffi-dev git python-virtualenv python-dev virt-manager xorg gnome-core gnome-system-tools gnome-app-install sshpass gnupg jq vlan sudo ansible"
</codeph></codeblock></li>
                                <li>Add the 802.1q module to the kernel on boot. The 802.1q standard
                                        supports VLAN tagging on an ethernet
                                        network.<codeblock><codeph>sudo su -c 'echo "8021q" &gt;&gt; /etc/modules'
</codeph></codeblock></li>
                                <li>Reboot the server</li>
                                <li>Log out and re-login to the lifecycle manager host to activate
                                                the proxy configuration.</li>
                        </ol>
                </section>
                <section id="configure-the-xrdp-remote-desktop-display"><title>Configure the XRDP
                                remote desktop display</title><p>Configure XRDP on the lifecycle manager host for the remote desktop connection to access the
                                        server remotely as follows.</p><ol>
                                <li>Edit the <codeph>sesman.ini</codeph> file: <ol>
                                                <li>Open the file:
                                                  <codeblock>vi /etc/xrdp/sesman.ini </codeblock></li>
                                                <li>Update the<codeph>MaxSessions=1</codeph> to
                                                  <codeph>MaxSessions=50</codeph>.</li>
                                                <li>Save and close the file.</li>
                                        </ol></li>
                                <li>Execute the following command to configure the system to use
                                        XRDP:<codeblock><codeph>echo "xfce4-session" &gt; ~/.xinitrc
</codeph></codeblock></li>
                                <li>Execute the following command to restart the XDRP service:
                                        <codeblock>sudo /etc/init.d/xrdp restart</codeblock></li>
                        </ol><p>If the XDRP display does not work as expected, (you see a gray
                                screen): <ol id="ol_hnf_vpk_yt">
                                        <li>Update the <codeph>startwm.sh</codeph>
                                                  file:<codeblock><codeph>vi /etc/xrdp/startwm.sh

#!/bin/sh

if [ -r /etc/default/locale ]; then
. /etc/default/locale
export LANG LANGUAGE
fi

#. /etc/X11/Xsession
. /usr/bin/startxfce4
</codeph>
</codeblock><p><b>Note:</b>
                                                  Make sure you add a space between
                                                  <codeph>.</codeph> and
                                                <codeph>/</codeph>.</p></li>
         
                                
                                <li>Restart
                                                  XDRP:<codeblock><codeph>sudo /etc/init.d/xrdp restart
</codeph></codeblock><p>When
                                                  you XRDP to the lifecycle manager host, the screen
                                                  appears similar to the following image:</p><image
                                                  href="../../../media/CGH-install-xrdp.png"
                                                  id="image_pln_cdm_vs"/>
                                                </li></ol></p></section>
                <section id="ntp">
                        <title>Install and configure NTP</title>
                        <p>You must configure the lifecycle manager host as an NTP client.</p>
                        <p>You can install NTP on the lifecycle manager host and configure it as an
                                        NTP server. Or, you can use a pre-existing NTP server that
                                        is reachable from the management network. </p>
                        <p>For information on configuring the lifecycle manager host as an NTP
                                        client, see <xref
                                                href="../prereqs/carrier-grade-install-NTP.dita#topic4740/client"
                                        />.</p>
                        <p>For information on installing NTP on the lifecycle manager host, see
                                                <xref
                                                href="../prereqs/carrier-grade-install-NTP.dita"
                                                >Installing an NTP Server</xref>.</p>
                </section>
                <section id="ssh">
                        <title>Configure SSH</title>
                        <p>On the lifecycle manager host, the OpenSSH server must be running and the
                                        firewall configuration should allow access to the SSH
                                        ports.</p>
                        <ol>
                                <li>Enable root login in the <codeph>/etc/ssh/sshd_config</codeph>:
                                                <ol id="ol_h13_kqk_yt">
                                                <li>Set the following values: </li>
                                        </ol><codeblock># Authentication:
LoginGraceTime 120
#PermitRootLogin without-password
PermitRootLogin yes
#StrictModes yes
StrictModes no
PermitRootLogin yes</codeblock></li>
                                <!--<li>In the <codeph>sshd_config</codeph> file, set the following
          variables:<codeblock><codeph># Authentication:
LoginGraceTime 120
#PermitRootLogin without-password
StrictModes no
</codeph></codeblock></li>
-->
                                <li>Disable strict host key checking: <ol id="ol_cxy_4rk_yt">
                                                <li>In the <codeph>~/.ssh/config</codeph> file
                                                  (create the file if it does not exist) add
                                                  following
                                                  lines<codeblock>Host *
StrictHostKeyChecking no </codeblock></li>
                                                <li>Save the file,</li>
                                        </ol></li>
                                <li>Restart the SSH
                                        service:<codeblock><codeph>service ssh restart</codeph></codeblock></li>
                                <li>Configure the public key and passwordless SSH access.<p>a. Enter
                                                the following
                                                command:</p><codeblock><codeph>ssh-keygen -t rsa </codeph></codeblock><p>b.
                                                Press Enter to use default path
                                                  (<codeph>/root/.ssh/id_rsa</codeph>)</p><p>c.
                                                Press Enter when prompted for the
                                                  <codeph>passphrase</codeph>.</p><p>d. Press Enter
                                                to confirm the empty
                                                <codeph>passphrase</codeph>.</p><p>The output of the
                                                public key will display, similar to the
                                                following:</p><codeblock><codeph>ssh-copy-id 192.168.122.1 </codeph></codeblock><p>If
                                                you get a <i>permission denied</i> error, make sure
                                                you are logged in as root.</p></li>
                        </ol>
                </section>
                <section id="network">
                        <title>Preparing the Network for Installation</title>
                        <p>Before installing HP Helion OpenStack Carrier Grade, you are responsible
                                for preparing the network for all installations.</p>
                        <p>See <xref href="../prereqs/carrier-grade-install-network-prepare.dita#topic7646cginp"
                                        >Preparing the Network for Installation</xref></p>
                </section>
                <section id="ldap">
                        <title>Integrating LDAP</title>
                        <p><b>OPTIONAL:</b> The HP Helion OpenStack Identity service can use
                                Lightweight Directory Access Protocol (LDAP) to integrate your
                                organization's existing directory service and user account
                                management processes.</p>
                        <p>See <xref href="../prereqs/carrier-grade-install-ldap-enabling.dita#topic10581cgile"
                                        >Enabling LDAP</xref></p>
                </section>
                <section id="prepbare">
                        <title>Prepare the servers</title>
                        <p>Perform the following tasks on each server you will use as a compute
                                server or controller in the non-KVM and KVM regions:</p>
                        <ul id="ul_jy1_tvp_rs">
                                <li>Configure the boot order with Network/PXE boot as the first
                                                option:<p>For example, to set the boot order for a
                                                HPE SL390, from the iLO prompt enter <codeph>set
                                                  system1/bootconfig1/bootsource5
                                                  bootorder=1</codeph>.</p></li>
                                <li>
                                        <p>Configure the BIOS:</p>
                                        <ul id="ul_ly1_tvp_rs">
                                                <li>to the correct date and time</li>
                                                <li>to use UTC (Coordinated Universal Time)</li>
                                                <li>with only one network interface enabled for
                                                  PXE/network boot and any additional interfaces
                                                  should have PXE/network boot disabled</li>
                                                <li>to stay powered off in the event of being
                                                  shutdown rather than automatically restarting</li>
                                        </ul>
                                </li>
                                <li>
                                        <p>Update to the latest firmware recommended by the system
                                                vendor for all system components, including the
                                                BIOS, BMC firmware, disk controller firmware, drive
                                                firmware, network adapter firmware, and so
                                                forth.</p>
                                        <p><b>Note:</b> If you are using ProLiant Gen9 blades or
                                                rack servers, you must update the Snap3 firmware.
                                        </p>
                                </li>
                        </ul>
                </section>
               </bodydiv>
                <section id="vsd">
                        <title>Bring Up Single VSD VM Manually</title>
                        <p>You must launch a virtual machine for the required HPE DCN Virtualized
                                Services Directory (<i>VSD</i>) and create required users.</p>
                        <p>For more information, see <xref
                                        href="../prereqs/carrier-grade-install-vsd-vm.dita#topic7646cgivv"
                                        >Bringing Up Single VSD VM Manually</xref>.</p>
                </section>
                
                <section
                        conref="../sacramento/CGH-2-install-sacramento.dita#topic10581c2is/conref-vmware-workaround"
                        id="conref-vmware-workaround"/>
                <section id="next-step">
                        <title>Next Step</title>
                        <p><xref
                                        href="carrier-grade-install-download-sacramento.dita#topic7148cgids"
                                        >Download the Installation Packages</xref></p>
                </section>
        </body>
</topic>
