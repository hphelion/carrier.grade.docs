<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="topic10581c2brc">
  <title>HP Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 2.0: Backup and Restore
    CLI</title>
  <prolog>
    <metadata>
      <othermeta name="layout" content="default"/>
      <othermeta name="product-version" content="HP Helion OpenStack Carreir Grade 1.1"/>
      <othermeta name="role" content="Storage Administrator"/>
      <othermeta name="role" content="Storage Architect"/>
      <othermeta name="role" content="Michael B"/>
      <othermeta name="product-version1" content="HP Helion OpenStack Carreir Grade 1.1"/>
    </metadata>
  </prolog>
  <body>
    <!-- https://wiki.hpcloud.net/pages/viewpage.action?pageId=53513771 -->
    <p><!-- Here is the wiki link for Attis. <xref href="https://rndwiki.corp.hpecorp.net/confluence/pages/viewpage.action?pageId=946944841" format="html" scope="external">https://rndwiki.corp.hpecorp.net/confluence/pages/viewpage.action?pageId=946944841</xref> 
The high level design needs to be adjusted to more suite with CG(It is reflecting CS in some areas)I will soon update it. 
But the CLI, REST API etc should all be same --></p>
    <p conref="CGH-2-attis-backup-restore.dita#topic10581c2abr/intro"/>
    <p>The following document describes the full Attis CLI for backing up and restoring. You can
      also use the built-in Attis help system by entering <systemoutput>attis help</systemoutput>
      before any command when working with the CLI. For example:</p>
    <p>
      <codeblock>attis help storage</codeblock>
    </p>
    <section conref="CGH-2-attis-backup-restore.dita#topic10581c2abr/resp"/>
    <section>
      <title>Synopsis</title>
    </section>
    <p id="attis">
      <codeblock>attis [command] --version -v --log-file [LOG_FILE] -q -h --debug</codeblock>
    </p>
    <p><b>Optional arguments</b></p>
    <p>
      <ul id="ul_ivp_wr3_pt">
        <li><codeph>--version</codeph>. Shows the Attis version number and exits. </li>
        <li><codeph>-v, --verbose</codeph>. Increases verbosity of output. Can be repeated. </li>
        <li><codeph>--log-file [LOG_FILE]</codeph>. Specifies a file to log output. Enter a path and
          file name for the log file. </li>
        <li><codeph>-q, --quiet</codeph>. Suppresses output except warnings and errors. </li>
        <li><codeph>-h, --help</codeph>. Shows help message and exits. </li>
        <li><codeph>--debug</codeph>. Shows tracebacks on errors.</li>
      </ul>
    </p>
    <p><b>Commands</b></p>
    <p>
      <ul id="ul_at4_3m3_k5">
        <li><systemoutput>backup</systemoutput>. Triggers the backup service.</li>
        <li><systemoutput>backuplog</systemoutput>. Shows backup logs.</li>
        <li><systemoutput>complete</systemoutput>. Prints bash completion command</li>
        <li><systemoutput>config</systemoutput>. Shows stored configuration for Attis service.</li>
        <li><systemoutput>help</systemoutput>. Shows detailed help for another command.</li>
        <li><systemoutput>job</systemoutput>. Shows previous Attis backup/restore jobs.</li>
        <li><systemoutput>queue</systemoutput>. Shows dispatcher queues.</li>
        <li><systemoutput>restore</systemoutput>. Triggers the Attis restore service.</li>
        <li><systemoutput>storage</systemoutput>. Shows storage configuration for the Attis
          service.</li>
        <li><systemoutput>task</systemoutput>. Shows previous Attis backup/restore tasks.</li>
      </ul>
    </p>
    <section conref="CGH-2-attis-backup-restore.dita#topic10581c2abr/authentication"/>
    <section>
      <title>Important commands</title>
    
    <p><b>Back up</b></p>
    <p>The following command triggers the backup service. Use <codeph>attis help backup</codeph> for
      more information.</p>
    <codeblock>attis backup [-h] [--config-id CONFIG_ID] [--config-path CONFIG_PATH]                   
        [--os-tenant-name TENANT_NAME] [--os-username USERNAME]                   
        [--os-password PASSWORD] [--os-auth-url AUTH_URL]
                        [--backup-type BACKUP_TYPE] </codeblock>
    <p><i>Arguments:</i>
      </p>
    <p>
      <ul id="ul_t3w_x53_pt">
        <li><codeph>--config-id [CONFIG_ID]</codeph>. Execute the backup using configuration with
            the specified ID. Use the <xref
              href="CGH-2-attis-backup-restore.dita#topic10581c2abr/attis-id">attis config</xref>
            command to obtain the ID. </li>
        <li><codeph>--config-path [CONFIG_PATH]</codeph>. Execute the backup using configuration
            from the specified path. The default location for the configuration files is
              <codeph>/etc/attis/config_template</codeph>. </li>
        <li><codeph>--backup-type [BACKUP_TYPE]</codeph>. Specify whether the backup is full or
            incremental. By default, the command executes a full backup.</li>
      </ul>
    </p>
    <p><b>Restore</b></p>
    <p>The following command triggers a restore. Use <codeph>attis help restore</codeph> for more
      information.</p>
    <codeblock>attis restore [-h] [--config-id CONFIG_ID] [--config-path CONFIG_PATH]                    
        [--backup-id BACKUP_ID] [--os-tenant-name TENANT_NAME]                    
        [--os-username USERNAME] [--os-password PASSWORD]
      [--os-auth-url AUTH_URL] </codeblock>
    <p><i>Arguments</i></p>
    <p>
      <ul id="ul_rrj_fw3_pt">
          <li><codeph>--config-id CONFIG_ID</codeph>. Execute the restore using configuration with
            the specified ID. Use the <xref
              href="CGH-2-attis-backup-restore.dita#topic10581c2abr/attis-id">attis config</xref>
            command to obtain the ID. </li>
          <li><codeph>--config-path CONFIG_PATH</codeph>. Execute the restore using configuration
            from the specified path. For example:<codeph>
              /opt/stack/attis-api/etc/attis/config_template/cloudcontrollerappliancedbrestore_scp.json</codeph>
          </li>
          <li><codeph>--backup-id BACKUP_ID</codeph>. Specifies the ID of the backup to use with the
            restore. Use the <xref href="#topic10581c2brc/attis" format="dita">attis job</xref>
            command to obtain the ID. </li>
        </ul>
    </p>
    <p><b>Storage</b></p>
    <p>The following command shows the storage parameters that have been configured for the Attis
        service. Use <codeph>attis help storage</codeph> for more information.  </p>
    <p><i>Synopsis</i></p>
    <p>
      <codeblock>attis storage --update '{"parameter":"new value", "parameter":"new value"}' --id &lt;storage_id from the table></codeblock>
    </p>
    <p><i>Arguments</i></p>
    <p>
      <ul id="ul_cdh_yvl_pt">
        <li><codeph>--id ID</codeph> Use this variable to display storage parameters for a specific
            ID.</li>
        <li><codeph>--type [TYPE]</codeph> Use this variable to display storage parameters for a
            specific type  The <codeph>[TYPE]</codeph> parameter is case-sensitive.</li>
        <li><codeph>--update UPDATE</codeph> Use this variable to mofidy the storage parameters with
            new values. Arguments should be dictionary format, for example:
              <codeph>'{"storage_path": "/tmp/mybackup"}'</codeph>. See <xref
              href="CGH-2--backup-configure.dita#topic10581c2bc/location">Configuring the Backup and
              Restore Location</xref> for an example of using this command.</li>
        <li><codeph>--use USE</codeph> Use this variable to specify the type of storage to use. The
            default is <codeph>SCP</codeph>. <p
              conref="CGH-2--backup-configure.dita#topic10581c2bc/type"/></li>
      </ul>
    </p>
  </section>
    <section id="examples">
      <title>Example commands</title>
      <p>The following table lists some typical Attis CLI commands.</p>
      <table id="table_q5x_5t3_pt">
        <tgroup cols="2">
          <colspec colnum="1" colname="col1"/>
          <colspec colnum="2" colname="col2"/>
          <tbody>
            <row>
              <entry><b>Command</b></entry>
              <entry><b>Action</b></entry>
            </row>
            <row>
              <entry>attis job</entry>
              <entry>Display a list of completed, failed and pending backup and restore jobs</entry>
            </row>
            <row>
              <entry>attis job --id [JOB_ID]</entry>
              <entry>Display the details of a specific backup/restore job using the job ID.</entry>
            </row>
            <row>
              <entry>attis job --name [JOB_NAME]</entry>
              <entry>Display a list of the backup/restore jobs with the specified name. </entry>
            </row>
            <row>
              <entry>attis job --last [N]</entry>
              <entry>Display a list of backup/restore jobs performed in the specified previous
                number of days.</entry>
            </row>
            <row>
              <entry>attis job --latest</entry>
              <entry>Display details of the latest backup/restore job.</entry>
            </row>
            <row>
              <entry>attis config</entry>
              <entry>Display a list of configuration files and associated ID number.</entry>
            </row>
            <row>
              <entry>attis config --id [CONFIG_ID]</entry>
              <entry>Display the details of a specified configuration file using the associated ID
                number</entry>
            </row>
            <row>
              <entry>attis config --type [TYPE]</entry>
              <entry>Display a list of the specified type of configuration files.</entry>
            </row>
            <row>
              <entry>attis config --id [CONFIG_ID] --update '{"timeout": 1200}'</entry>
              <entry>
                <p>Modify the timeout value for the specified configuration. Arguments should be
                  dictionary format.</p>
              </entry>
            </row>
            <row>
              <entry>attis config --id [CONFIG_ID] --update-parameter
                '{"Percona_XtraDB_Backup_dbuser": "myuser", "Percona_XtraDB_Backup_dbpassword":
                "mypassword"}'</entry>
              <entry>
                <p>Modify the database user name and password for the specified configuration.
                  Arguments should be dictionary format.</p>
              </entry>
            </row>
            <row>
              <entry>attis backuplog</entry>
              <entry>Display a list of backup logs.</entry>
            </row>
            <row>
              <entry>attis backuplog --id [BACKUP_LOG_ID]</entry>
              <entry>Display the backup logs with the specified ID number.</entry>
            </row>
            <row>
              <entry>attis backuplog --name [BACKUP_LOG_NAME]</entry>
              <entry>Display a list of backup logs of the specified name.</entry>
            </row>
            <row>
              <entry>attis backuplog --last [N]</entry>
              <entry>Display a list of backup logs generated in the specified previous number of
                days.</entry>
            </row>
            <row>
              <entry>attis backuplog --latest</entry>
              <entry>Display the most recent backup log.</entry>
            </row>
            <row>
              <entry>attis backup --config-id [CONFIG_ID]</entry>
              <entry>Execute the backup job with parameters in the specified from
                configuration.</entry>
            </row>
            <row>
              <entry>attis backup --config-id [CONFIG_ID] --backup_type [BACKUP_TYPE]</entry>
              <entry>Execute the a full or incremental backup job with using the specified
                configuration.</entry>
            </row>
            <row>
              <entry>attis restore --config-id [CONFIG_ID] --backup-id [BACKUP_ID]</entry>
              <entry>Restore the specified backup job [BACKUP_ID] using the specified
                configuration.</entry>
            </row>
            <row>
              <entry>attis storage</entry>
              <entry>Display a list of storage configuration types (NFS, SCP, or FILE).</entry>
            </row>
            <row>
              <entry>attis storage --id [STORAGE_ID]</entry>
              <entry>Display the details of the specified storage configuration.</entry>
            </row>
            <row>
              <entry>attis storage --type [STORAGE_TYPE]</entry>
              <entry>Display details of the specified storage configuration type.</entry>
            </row>
            <row>
              <entry>attis storage --id [STORAGE_ID] --update '{"storage_path":""}'</entry>
              <entry>Modify the path to the location for storing the backup files. (arguments should
                be dictionary format)</entry>
            </row>
            <row>
              <entry>attis storage --use [STORAGE_TYPE]</entry>
              <entry>Specify the format to use for storing backups (NFS, SCP, or TYPE).</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </section>
  </body>
</topic>
