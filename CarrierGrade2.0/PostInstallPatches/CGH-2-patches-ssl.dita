<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="topic10581pdps">
  <title>HP Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 2.0: Deploy the SSL Patch</title>
  <prolog>
    <metadata>
      <othermeta name="layout" content="default"/>
      <othermeta name="product-version" content="HP Helion OpenStack Carreir Grade 1.1"/>
      <othermeta name="role" content="Storage Administrator"/>
      <othermeta name="role" content="Storage Architect"/>
      <othermeta name="role" content="Michael B"/>
      <othermeta name="product-version1" content="HP Helion OpenStack Carreir Grade 1.1"/>
    </metadata>
  </prolog>
  <body>
    <section id="ssl"><p>If you did not deploy the <codeph>kcp-ssl-implementation.patch</codeph>
        during installation, perform the following steps: <!--HCG-998--></p><p>This patch addresses
        a number of issues. </p><p><b>Note:</b> If you can view statistics in
          <codeph>regionkvm</codeph>, from the <b>Stats</b> tab on the <b>Resource Usage
          Overview</b> page, you can disregard these steps. Select the <codeph>regionkvm</codeph>,
        then click <b>Admin</b>, then <b>System</b>, and <b>Resrouce Usage</b>. Click the
          <b>Stats</b> table.</p>You should have downloaded the following patch files during the
      prerequisites: <!--HCG-998--><ul id="ul_i42_qhz_35">
        <li>kcp-ssl-implem</li>
      </ul></section>
    <section><title>Download the patch</title><p>If you have not downloaded the patch, launch the
          <xref href="https://helion.hpwsportal.com/catalog.html#/Home/Show" format="html"
          scope="external">Helion Distribution Network (HDN)</xref>. You must <xref
          href="https://idm.pod1.prod-core.hpwsportal.com/webid/" format="html" scope="external"
          >obtain a user account on HDN</xref> in order to download these files. </p>In a browser,
      navigate to <xref href="https://helion.hpwsportal.com/catalog.html#/Home/Show" format="html"
        scope="external">Helion Download Network(HDN)</xref>. <ol id="ul_lvg_jb2_xs">
        <li>Click <b>Sign In</b> to log in using your account. </li>
        <li>After signing in, click the <b>Downloads</b> link in the menu on the left side of the
          page.</li>
        <li>Download the <b
            conref="../Installation/prereqs/carrier-grade-install-download.dita#topic7148cgid/003"/>
          patch and the associated checksum and signature files.</li>
        <li>Verify the <xref
            href="../Installation/prereqs/carrier-grade-install-download.dita#topic7148cgid/verify"
            >downloaded signature</xref> and the <xref
            href="../Installation/prereqs/carrier-grade-install-download.dita#topic7148cgid/checksum"
            >downloaded checksums</xref>.</li>
        <li>Extract the compressed files until the <codeph>kcp-ssl-implementation.patch</codeph>,
            <codeph>knc-ssl-implementation.patch</codeph> and <codeph>readme.txt</codeph> files are
          available.</li>
      </ol></section>
    <section>
      <title>Install the patch</title>
      <p>The patch is in a compressed file called <codeph>HCG2.0_Heat001_Patch003.tar.gz</codeph>.
        The README with the patch download contains information on files changed by these
        patches.</p>
      <p>To prevent this condition, execute the following commands:<ol id="ol_j42_qhz_35">
          <li>Log onto the lifecycle manager VM.<codeblock>ssh &lt;HLM_VM_IP></codeblock><p>where:
              HLM_VM_IP is the CLM IP of the lifecycle manager. Locate the IP address for the
              lifecycle manager in the <codeph>/root/infra-ansible-playbooks/group_vars/all</codeph>
              file under <codeph>hlm_clmstaticip</codeph> field.</p></li>
          <li>Copy the patch file to <codeph>~/</codeph> on the lifecycle manager. </li>
          <li>Change to the <codeph>kenobi-configuration-processor</codeph>
            directory:<codeblock>cd ~/kenobi-configuration-processor</codeblock></li>
          <li>Execute the following command to install the patch
            <codeblock>patch -p1 &lt; ../kcp-ssl-implementation.patch</codeblock></li>
          <li>Change to the <codeph>kenobi-node-configuration</codeph>
            directory:<codeblock>cd ~/kenobi-node-configuration</codeblock></li>
          <li>Execute the following command to install the second patch
            <codeblock>patch -p1 &lt; ../knc-ssl-implementation.patch</codeblock></li>
          <li>Change to the <codeph>~/cg-hlm/hlm-build</codeph> directory
            <codeblock>cd ~/cg-hlm/hlm-build</codeblock></li>
          <li>Execute the following command to integrate the changes into the
            environment:<codeblock>./hlm_prepare-env.sh</codeblock></li>
          <li>Execute the following
            command:<codeblock>hlm generate -c &lt;cloud name></codeblock></li>
          <li>Execute the following command to create haproxy, stunnel and horizon roles
            <codeblock>hlm deploy -c &lt;cloud name> -t "FND-CLU FND-STN HZN-WEB WR-HZN" </codeblock></li>
          <li>Change to the following directory:
            <codeblock>cd /var/hlm/clouds/&lt;cloud name>/desired_state/&lt;cloud name>/001/base/stage/windriver-config </codeblock></li>
          <li>Copy contents of <codeph>cakey.pem</codeph> file in that directory to the
              <codeph>server-cert.pem</codeph> in the <codeph>/etc/ssl/private</codeph> directory on
            KVM region <codeph>controller-0</codeph>. Make sure you make a backup copy of the
              <codeph>server-cert.pem</codeph> before the copy operation.</li>
          <li>Execute the following command on KVM region <codeph>controller-0</codeph> to restart
            the haproxy service: <codeblock>service haproxy restart</codeblock></li>
          <li>Log onto the KVM region <codeph>controller-1</codeph>, the standby controller.</li>
          <li>Copy contents of <codeph>cakey.pem</codeph> file on the lifycycle manager to the
              <codeph>server-cert.pem</codeph> in the <codeph>/etc/ssl/private</codeph> directory on
            KVM region <codeph>controller-0</codeph>. Make sure you make a backup copy of the
              <codeph>server-cert.pem</codeph> before the copy operation.</li>
        </ol></p>
    </section>
  </body>
</topic>
