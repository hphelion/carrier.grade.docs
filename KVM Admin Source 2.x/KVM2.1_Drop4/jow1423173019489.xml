<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept-wr PUBLIC "-//WindRiver.com//DTD DITA 1.2 Wind River Concept//EN" "concept-wr.dtd">
<concept-wr domains="(topic concept concept-wr)                            (topic hi-d)                            (topic indexing-d)                            (topic pr-d)                            (topic sw-d)                            (topic ui-d)                            (topic wr-sw-d)                            (topic xml-d)   " id="jow1423173019489" xml:lang="en-us" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
<!-- Modification History

 -->
 <title>Shared (VLAN) Ethernet Interfaces</title>
 <shortdesc>The management, OAM, infrastructure, and data networks can share Ethernet
    or aggregated Ethernet interfaces using VLAN tagging.</shortdesc>
 <prolog><author/>
  <author/>
 </prolog>
 <conbody>
    <p>As explained in <xref href="jow1404333674324.xml"/>, the
      internal management network cannot use VLAN tagging. However, the OAM, infrastructure, and
      data networks can use VLAN tagging, allowing them to share an Ethernet or aggregated Ethernet
      interface with other networks.</p>
    <note id="note_N1002C_N1001F_N10001">
      <p>You cannot configure a data VLAN or add a data network on an aggregated
        Ethernet interface.</p>
    </note>
    <p>For a system using all four networks, the following arrangements are
      possible:</p>
    <ul id="ul_y5k_zg2_zq">
      <li>
        <p>One interface for the management network, another interface for the OAM
          network, a third for the infrastructure network, and one or more additional interfaces for
          data networks.</p>
      </li>
      <li>
        <p>One interface for the management network, and a second interface for
          either the OAM or infrastructure network, with the remaining networks implemented using
          VLAN tagging on either interface.</p>
      </li>
      <li>
        <p>One interface for the management network, and a second carrying the OAM
          and infrastructure networks, both implemented using VLAN tagging, with data networks
          implemented on either or both interfaces using VLAN tagging.</p>
      </li>
      <li>
        <p>One interface for the management network, with the OAM, infrastructure,
          and data networks also implemented on it using VLAN tagging.</p>
      </li>
    </ul>
    <note id="note_N100E6_N1001F_N10001">
      <p>Data networks implemented using VLAN tagging are not compatible with
        VLAN-based provider networks. (Stacked VLANs are not supported.). To support VLAN provider
        networks, you can configure a data network on a management or infrastructure interface by
        editing the interface and selecting both types of network, and then selecting the VLAN
        provider network. For more information, see the Network Type discussion in the <cite>HP Helion OpenStack Carrier Grade Installation Guide: Interface Settings</cite>. </p>
    </note>
    <p>Options to share an interface using VLAN tagging are presented during the
      configuration controller script (see the <cite>HP Helion OpenStack Carrier Grade Installation
        Guide: The Controller Configuration Script</cite>). To attach an interface to other networks
      after configuration, you can edit the interface; for details, see the <cite>HP Helion OpenStack Carrier Grade Installation Guide: Attaching to Networks Using a VLAN Interface</cite>. </p>
    <p>You can also use the command line by logging into the active controller and
      becoming the Keystone <nameliteral>admin</nameliteral> user, and then using a
      command such as the following for each node:</p>
    <codeblock><systemoutput>~(keystone_admin)$ </systemoutput><userinput>system host-if-add controller-0 -V 22 -nt infra infra0 vlan none eth1</userinput>
<systemoutput>+------------------+--------------------------------------+
| Property         | Value                                |
+------------------+--------------------------------------+
| ifname           | infra0                               |
| networktype      | infra                                |
| iftype           | vlan                                 |
| ports            | []                                   |
| providernetworks | None                                 |
| imac             | 08:00:27:f2:0d:68                    |
| imtu             | 1500                                 |
| aemode           | None                                 |
| schedpolicy      | None                                 |
| txhashpolicy     | None                                 |
| uuid             | 8ca9854e-a18e-4a3c-8afe-f050da702fdf |
| ihost_uuid       | 3d207384-7d30-4bc0-affe-d68ab6a00a5b |
| vlan_id          | 22                                   |
| uses             | [u'eth1']                            |
| used_by          | []                                   |
| created_at       | 2015-02-04T16:23:28.917084+00:00     |
| updated_at       | None                                 |
+------------------+--------------------------------------+
</systemoutput></codeblock>
    <p>This example configures the <nameliteral>eth1</nameliteral>
      interface on <nameliteral>controller-0</nameliteral> to connect to the
      infrastructure network using VLAN ID 22. (The <nameliteral>none</nameliteral>
      parameter is used in place of a provider network name, indicating no provider network.)</p>
    <p>To display VLAN information as well as dependencies, use a command such as
      the following:</p>
    <codeblock><systemoutput>~(keystone_admin)$ </systemoutput><userinput>system host-if-list controller-0</userinput>
<systemoutput>...+--------+------...+----------+---------+-----------+------------+-------------+...
...| name   | netwo...| type     | vlan id | ports     | uses i/f   | used by i/f |...
...+--------+------...+----------+---------+-----------+------------+-------------+...
...| infra0 | infra...| vlan     | 22      | []        | [u'mgmt0'] | []          |...
...| oam0   | oam  ...| ethernet | None    | [u'eth0'] | []         | []          |...
...| mgmt0  | mgmt ...| ethernet | None    | [u'eth1'] | []         | [u'infra0'] |...
...+--------+------...+----------+---------+-----------+------------+-------------+...</systemoutput>
</codeblock>
    <p>The output lists all interfaces and associated networks. For each network
      that uses VLAN tagging, the <nameliteral>vlan id</nameliteral> is shown, as
      well as the shared interface used (in the <nameliteral>uses i/f</nameliteral>
      column). For shared interfaces, the names of the networks that use VLAN tagging on the
      interface are shown (in the <nameliteral>used by i/f</nameliteral>
      column).</p>
    <p>For a LAG interface, the dependencies are shown as follows.</p>
    <codeblock><systemoutput>...+--------+------...+----------+---------+-----------+------------+-------------+...
...| name   | netwo...| type     | vlan id | ports     | uses i/f   | used by i/f |...
...+--------+------...+----------+---------+-----------+------------+-------------+...
...| oam0   | oam  ...| ethernet | None    | [u'eth0'] | []         | []          |...
...| bond0  | mgmt ...| ae       | None    | []        | [u'eth1']  | []          |...
...| eth1   | None ...| ethernet | None    | [u'eth1'] | []         | [u'bond0']  |...
...| infra0 | infra...| ethernet | None    | [u'eth3'] | []         | []          |...
...+--------+------...+----------+---------+-----------+------------+-------------+...</systemoutput>
</codeblock>
    <p> To see all available interfaces, add the <option>-a</option> flag.</p>
    <codeblock><systemoutput>~(keystone_admin)$ </systemoutput><userinput>system host-if-list -a controller-0</userinput>
<systemoutput>...+--------+------...+----------+---------+-----------+------------+-------------+...
...| name   | netwo...| type     | vlan id | ports     | uses i/f   | used by i/f |...
...+--------+------...+----------+---------+-----------+------------+-------------+...
...| eth3   | None ...| ethernet | None    | [u'eth3'] | []         | []          |...
...| infra0 | infra...| vlan     | 22      | []        | [u'mgmt0'] | []          |...
...| eth2   | None ...| ethernet | None    | [u'eth2'] | []         | []          |...
...| oam0   | oam  ...| ethernet | None    | [u'eth0'] | []         | []          |...
...| mgmt0  | mgmt ...| ethernet | None    | [u'eth1'] | []         | [u'infra0'] |...
...+--------+------...+----------+---------+-----------+------------+-------------+...</systemoutput></codeblock>
  </conbody>
</concept-wr>