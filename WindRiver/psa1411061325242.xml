<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task-wr PUBLIC "-//WindRiver.com//DTD DITA 1.2 Wind River General Task//EN" "task-wr.dtd">
<task-wr domains="(topic task task-wr)                            (topic hi-d)                            (topic pr-d)                            (topic sw-d)                            (topic ui-d)                            (topic wr-sw-d)                            (topic xml-d)   " id="psa1411061325242" xml:lang="en-us" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
<!-- Modification History
        
-->
    <title ixia_locid="1">Backing Up Available Cinder Volumes</title>
    <shortdesc ixia_locid="2">You can back up Cinder volumes in the <i ixia_locid="3">available</i>
        state.</shortdesc>
    <prolog>
        <author ixia_locid="4">Pedro Sanchez</author>
    </prolog>
    <taskbody>
        <context id="context_N10023_N10020_N10001" ixia_locid="5">
            <p ixia_locid="6">A Cinder volume in the <i ixia_locid="9">available</i> state is the ideal
                candidate for a backup operation in that there are no running instances using it. </p>
        </context>
        <steps>
            <step id="step_N1003A_N10037_N10024_N10001" ixia_locid="80">
                <cmd ixia_locid="19">Log in as Keystone user <nameliteral ixia_locid="81">admin</nameliteral> to the active controller.</cmd>
                <info ixia_locid="82">
                    <p ixia_locid="83">Log in as user <nameliteral ixia_locid="84">wrsroot</nameliteral> to the active controller and source the script
                            <filepath ixia_locid="85">/etc/nova/openrc</filepath> to obtain
                        administrative privileges. For more information, see <ph ixia_locid="94" otherprops="printonly"><cite ixia_locid="95">Titanium Server System Administration:
                            </cite></ph><cite ixia_locid="96"><ph ixia_locid="97"><xref href="ekn1460051057968.xml" ixia_locid="98"/></ph></cite>.</p>
                </info>
            </step>
            <step id="step_N1002E_N1002B_N10020_N10001" ixia_locid="7">
                <cmd ixia_locid="8">Identify the volume you want to back up.</cmd>
                <substeps id="substeps_aqf_dsz_lp">
                    <substep ixia_locid="13">
                        <cmd ixia_locid="14">List Cinder volumes from all tenants.</cmd>
                        <stepxmp ixia_locid="15">
                            <codeblock ixia_locid="16"><systemoutput ixia_locid="72">~(keystone_admin)$ </systemoutput><userinput ixia_locid="87">cinder list --all-tenants</userinput>
<systemoutput ixia_locid="73">﻿+--------------+-----------+-----------------+------+-------------+----------
|   ID         |   Status  |   Display Name  | Size | Volume Type | Bootable 
+--------------+-----------+-----------------+------+-------------+----------
| 593111d8-... | in-use    | volume-1        |  1   |     None    |   true   
| 53ad007a-... | available | volume-2        |  10  |     None    |   false  
+--------------+-----------+-----------------+------+-------------+----------
+---------------+
| Attached to   |
+---------------+
|  ﻿b998107b-... |
|               |
+---------------+﻿</systemoutput></codeblock>
                        </stepxmp>
                        <info ixia_locid="88">
                            <p ixia_locid="21">Cinder volumes are listed also on the <wintitle ixia_locid="22">Volumes</wintitle> page of the web
                                administration interface.</p>
                        </info>
                    </substep>
                    <substep ixia_locid="89">
                        <cmd ixia_locid="24">Identify the volume to back up.</cmd>
                        <info ixia_locid="25">
                            <p ixia_locid="26">In the list above, <nameliteral ixia_locid="27">volume-1</nameliteral> is a disk image associated with a
                                running instance. The volume <nameliteral ixia_locid="28">volume-2</nameliteral>, with UUID <nameliteral ixia_locid="29">53ad007a-...</nameliteral>, is available and can be safely
                                backed up. </p>
                        </info>
                    </substep>
                </substeps>
            </step>
            <step id="step_N10097_N10036_N10024_N10001" ixia_locid="30">
                <cmd ixia_locid="31">Export the target volume to the controller's file system.</cmd>
                <stepxmp ixia_locid="32">
                    <codeblock ixia_locid="33"><systemoutput ixia_locid="74">~(keystone_admin)$ </systemoutput><userinput ixia_locid="35">cinder export 53ad007a-841a-4fd3-a22b-813d4a6a8a85</userinput>
<systemoutput ixia_locid="75">+---------------------+--------------------------------------+
|       Property      |                Value                 |
+---------------------+--------------------------------------+
| display_description |                                      |
|          id         | 53ad007a-841a-4fd3-a22b-813d4a6a8a85 |
|         size        |                  1                   |
|        status       |              exporting               |
|      updated_at     |      2014-09-18T21:36:15.247881      |
|     volume_type     |                 None                 |
+---------------------+--------------------------------------+</systemoutput></codeblock>
                </stepxmp>
                <info ixia_locid="37">
                    <p ixia_locid="38">Exporting the volume takes some time, longer times for larger
                        volumes. While it is taking place, the status of the volume is set to <i ixia_locid="39">exporting</i>, which you can verify by issuing the
                        command <cmdname ixia_locid="40">cinder show </cmdname>
                        <varname ixia_locid="79">UUID</varname>, or <cmdname ixia_locid="41">cinder list
                            --all-tenants</cmdname> again. This new state is automatically reported
                        on the Web administration interface.</p>
                    <p ixia_locid="42">You must wait for the export operation to complete. Use the
                        command <cmdname ixia_locid="68">cinder show 53ad007a-...</cmdname> and look for the
                            <nameliteral ixia_locid="69">backup_status</nameliteral> field to determine whether the
                        export operation was successful. The state of the volume should be set to
                            <i ixia_locid="43">available</i> again.</p>
                </info>
                <stepresult ixia_locid="44">
                    <p ixia_locid="45">When the export operation completes, the backup file is ready, as illustrated
                        in the following example:</p>
                    <codeblock ixia_locid="46"><systemoutput ixia_locid="76">~(keystone_admin)$ </systemoutput><userinput ixia_locid="48">ls -lh /opt/backups</userinput>
<systemoutput ixia_locid="77">total 306M
drwx------ 2 root root  16K Sep 10 17:42 lost+found
drwxr-xr-x 2 root root 4.0K Sep 18 21:42 temp
-rw-r--r-- 1 root root 305M Sep 18 21:42 volume-53ad007a-841a-4fd3-a22b-813d4a6a8a85-20140918-213918.tgz</systemoutput></codeblock>
                </stepresult>
            </step>
            <step id="step_N100E2_N10036_N10024_N10001" ixia_locid="50">
                <cmd ixia_locid="51">Transfer the backup file to an external storage resource.</cmd>
                <info ixia_locid="52">
                    <p ixia_locid="53">The following example uses the <cmdname ixia_locid="54">scp</cmdname> command to transfer the
                        backup file to the directory <filepath ixia_locid="55">/backups/titanium</filepath> on a
                        server named <nameliteral ixia_locid="56">backups-server.wrs.com</nameliteral>:</p>
                </info>
                <stepxmp ixia_locid="57">
                    <codeblock ixia_locid="58"><systemoutput ixia_locid="78">~(keystone_admin)$ </systemoutput><userinput ixia_locid="90">scp /opt/backups/volume-53ad007a-841a-4fd3-a22b-813d4a6a8a85-20140918-213918.tgz admin@backups-server.wrs.com:/backups/titanium</userinput></codeblock>
                </stepxmp>
            </step>
            <step id="step_N1010C_N10036_N10024_N10001" ixia_locid="91">
                <cmd importance="optional" ixia_locid="92">Delete the backup file.</cmd>
                <info ixia_locid="93">
                    <p ixia_locid="64">You may want to free up disk space on the controller to
                        accommodate additional Cinder volume backups.</p>
                </info>
            </step>
        </steps>
        <result id="result_N1011B_N10024_N10001" ixia_locid="65">
            <p ixia_locid="66">The volume backup is complete. Repeat this procedure with all other Cinder volumes in
                the <i ixia_locid="67">available</i> state in the system.</p>
        </result>
    </taskbody>
</task-wr>