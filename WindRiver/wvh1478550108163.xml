<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept-wr PUBLIC "-//WindRiver.com//DTD DITA 1.2 Wind River Concept//EN" "concept-wr.dtd">
<concept-wr id="wvh1478550108163" xml:lang="en-us">
<!-- Modification History

 -->
 <title ixia_locid="1">DRBD Synchronization</title>
 <shortdesc ixia_locid="2">Titanium Server uses DRBD to synchronize storage between controller nodes.</shortdesc>
 <prolog>
  <author ixia_locid="3">Craig Griffin</author>
 </prolog>
 <conbody>
  <p ixia_locid="4"> Steady-state synchronization occurs in real time. Initial synchronization or resynchronization
   is restricted to avoid overloading the network and storage devices with synchronization traffic.
   For large disks, this requires a significant amount of time during which the controller is in a
   degraded state.</p>
  <p ixia_locid="5">The following partitions are synchronized between the controllers:</p>
  <ul id="ul_nfb_gzk_wx">
   <li ixia_locid="6">
    <p ixia_locid="7">Postgres</p>
   </li>
   <li ixia_locid="8">
    <p ixia_locid="9">RabbitMQ</p>
   </li>
   <li ixia_locid="10">
    <p ixia_locid="11">Platform</p>
   </li>
   <li ixia_locid="12">
    <p ixia_locid="13">Images</p>
   </li>
   <li ixia_locid="14">
    <p ixia_locid="15">Cinder (Controller Storage and CPE Configurations Only)</p>
   </li>
  </ul>
  <p ixia_locid="16">The reference configurations below were used to benchmark the default DRDB performance and
   provide guidance on DRBD synchronization times. Both configurations use the default DRBD
   synchronization settings and use SSD for the primary storage. For Cinder, one configuration uses
   a 10K RPM SAS disk and the other uses SSD. </p>
  <p ixia_locid="17">Configuration 1:</p>
  <ul id="ul_ofb_gzk_wx">
   <li ixia_locid="150">
    <p ixia_locid="151">Intel® Broadwell Processor - Intel(R) Xeon(R) CPU E5-2699 v4 @ 2.20GHz</p>
   </li>
   <li ixia_locid="18">
    <p ixia_locid="19">Primary Disk - INTEL SSDSC2BB48 480 GB SSD</p>
   </li>
   <li ixia_locid="20">
    <p ixia_locid="21">Cinder Disk – Seagate ST1200MM0018 1200 GB 10K RPM SAS</p>
   </li>
   <li ixia_locid="22">
    <p ixia_locid="23">Storage Controllers</p>
    <ul id="ul_pfb_gzk_wx">
     <li ixia_locid="24">
      <p ixia_locid="25">Intel Corporation C610/X99 series chipset SATA Controller [AHCI mode] (rev 05)</p>
     </li>
     <li ixia_locid="26">
      <p ixia_locid="27">Intel Corporation C610/X99 series chipset 6-Port SATA Controller [AHCI mode] (rev 05)</p>
     </li>
    </ul>
   </li>
  </ul>
  <p ixia_locid="28">Configuration 2:</p>
  <ul id="ul_qfb_gzk_wx">
   <li ixia_locid="152">
    <p ixia_locid="153">Intel® Broadwell Processor - Intel(R) Xeon(R) CPU E5-2699 v4 @ 2.20GHz</p>
   </li>
   <li ixia_locid="29">
    <p ixia_locid="30">Primary Disk - INTEL SSDSC2BB48 480 GB SSD</p>
   </li>
   <li ixia_locid="31">
    <p ixia_locid="32">Cinder Disk – Seagate ST1200MM0018 1200 GB 10K RPM SAS</p>
   </li>
   <li ixia_locid="33">
    <p ixia_locid="34">Storage Controllers</p>
    <ul id="ul_rfb_gzk_wx">
     <li ixia_locid="35">
      <p ixia_locid="36">Intel Corporation C610/X99 series chipset SATA Controller [AHCI mode] (rev 05)</p>
     </li>
     <li ixia_locid="37">
      <p ixia_locid="38">Intel Corporation C610/X99 series chipset 6-Port SATA Controller [AHCI mode] (rev 05)</p>
     </li>
    </ul>
   </li>
  </ul>
  <table id="table_sfb_gzk_wx">
   <title ixia_locid="39">Configuration 1 (SAS) Reults</title>
   <tgroup cols="6">
    <colspec colname="col1" colnum="1"/>
    <colspec colname="col2" colnum="2"/>
    <colspec colname="col3" colnum="3"/>
    <colspec colname="col4" colnum="4"/>
    <colspec colname="col5" colnum="5"/>
    <colspec colname="col6" colnum="6"/>
    <thead>
     <row>
      <entry ixia_locid="40"/>
      <entry ixia_locid="41">
       <p ixia_locid="42">postgres</p>
       <p ixia_locid="43">(SSD)</p>
      </entry>
      <entry ixia_locid="44">
       <p ixia_locid="45">rabbitmq</p>
       <p ixia_locid="46">(SSD)</p>
      </entry>
      <entry ixia_locid="47">
       <p ixia_locid="48">platform (SSD)</p>
      </entry>
      <entry ixia_locid="49">
       <p ixia_locid="50">images (SSD)</p>
      </entry>
      <entry ixia_locid="51">
       <p ixia_locid="52">Cinder</p>
       <p ixia_locid="53">(SAS)</p>
      </entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry ixia_locid="54">
       <p ixia_locid="55">Partition Size (GB)</p>
      </entry>
      <entry ixia_locid="56">
       <p ixia_locid="57">50</p>
      </entry>
      <entry ixia_locid="58">
       <p ixia_locid="59">2</p>
      </entry>
      <entry ixia_locid="60">
       <p ixia_locid="61">2</p>
      </entry>
      <entry ixia_locid="62">
       <p ixia_locid="63">330</p>
      </entry>
      <entry ixia_locid="64">
       <p ixia_locid="65">1000</p>
      </entry>
     </row>
     <row>
      <entry ixia_locid="66">
       <p ixia_locid="67">Sync Time (minutes)</p>
      </entry>
      <entry ixia_locid="68">
       <p ixia_locid="69">05:01</p>
      </entry>
      <entry ixia_locid="70">
       <p ixia_locid="71">&lt; 00:30</p>
      </entry>
      <entry ixia_locid="72">
       <p ixia_locid="73">&lt; 00:30</p>
      </entry>
      <entry ixia_locid="74">
       <p ixia_locid="75">25:10</p>
      </entry>
      <entry ixia_locid="76">
       <p ixia_locid="77">50:05</p>
      </entry>
     </row>
     <row>
      <entry ixia_locid="78">
       <p ixia_locid="79">Sync Rate (MB/sec)</p>
      </entry>
      <entry ixia_locid="80">
       <p ixia_locid="81">170</p>
      </entry>
      <entry ixia_locid="82">
       <p ixia_locid="83">N/A</p>
      </entry>
      <entry ixia_locid="84">
       <p ixia_locid="85">N/A</p>
      </entry>
      <entry ixia_locid="86">
       <p ixia_locid="87">224</p>
      </entry>
      <entry ixia_locid="88">
       <p ixia_locid="89">155</p>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>
  <p ixia_locid="90"> </p>
  <table id="table_xfb_gzk_wx">
   <title ixia_locid="91">Configuration 2 (SSD)</title>
   <tgroup cols="6">
    <colspec colname="col1" colnum="1"/>
    <colspec colname="col2" colnum="2"/>
    <colspec colname="col3" colnum="3"/>
    <colspec colname="col4" colnum="4"/>
    <colspec colname="col5" colnum="5"/>
    <colspec colname="col6" colnum="6"/>
    <thead>
     <row>
      <entry ixia_locid="92"/>
      <entry ixia_locid="93">
       <p ixia_locid="94">postgres</p>
       <p ixia_locid="95">(SSD)</p>
      </entry>
      <entry ixia_locid="96">
       <p ixia_locid="97">rabbitmq</p>
       <p ixia_locid="98">(SSD)</p>
      </entry>
      <entry ixia_locid="99">
       <p ixia_locid="100">platform (SSD)</p>
      </entry>
      <entry ixia_locid="101">
       <p ixia_locid="102">images (SSD)</p>
      </entry>
      <entry ixia_locid="103">
       <p ixia_locid="104">Cinder</p>
       <p ixia_locid="105">(SSD)</p>
      </entry>
     </row>
    </thead>
    <tbody>
     
     <row>
      <entry ixia_locid="106">
       <p ixia_locid="107">Partition Size (GB)</p>
      </entry>
      <entry ixia_locid="108">
       <p ixia_locid="109">50</p>
      </entry>
      <entry ixia_locid="110">
       <p ixia_locid="111">2</p>
      </entry>
      <entry ixia_locid="112">
       <p ixia_locid="113">2</p>
      </entry>
      <entry ixia_locid="114">
       <p ixia_locid="115">330</p>
      </entry>
      <entry ixia_locid="116">
       <p ixia_locid="117">446</p>
      </entry>
     </row>
     <row>
      <entry ixia_locid="118">
       <p ixia_locid="119">Sync Time (minutes)</p>
      </entry>
      <entry ixia_locid="120">
       <p ixia_locid="121">04:56</p>
      </entry>
      <entry ixia_locid="122">
       <p ixia_locid="123">&lt; 00:30</p>
      </entry>
      <entry ixia_locid="124">
       <p ixia_locid="125">&lt; 00:30</p>
      </entry>
      <entry ixia_locid="126">
       <p ixia_locid="127">26:04</p>
      </entry>
      <entry ixia_locid="128">
       <p ixia_locid="129">36:11</p>
      </entry>
     </row>
     <row>
      <entry ixia_locid="130">
       <p ixia_locid="131">Sync Rate (MB/sec)</p>
      </entry>
      <entry ixia_locid="132">
       <p ixia_locid="133">173</p>
      </entry>
      <entry ixia_locid="134">
       <p ixia_locid="135">N/A</p>
      </entry>
      <entry ixia_locid="136">
       <p ixia_locid="137">N/A</p>
      </entry>
      <entry ixia_locid="138">
       <p ixia_locid="139">216</p>
      </entry>
      <entry ixia_locid="140">
       <p ixia_locid="141">210</p>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>
  <p ixia_locid="142">The DRBD synchronization has a tunable sync rate algorithm that can be used to account for
   replication link speed and achieve an expected level of parallelism and networking utilization
   that may be different from the defaults. The default settings are designed such that DRBD will
   not impact storage and disk utilization to the point that it significantly impacts service.
   Titanium Server provides some ability to tune the maximum sync rate based on the system
   configuration and performance. It is assumed the setting will be low enough that the DRBD link
   (usually the infrastructure network) is not saturated.</p>
  <ul id="ul_yfb_gzk_wx">
   <li ixia_locid="143">
    <p ixia_locid="144">Reducing parallel (e.g. from 2 to 1) has the effect of increasing max sync rate by 2x.</p>
   </li>
   <li ixia_locid="145">
    <p ixia_locid="146">Increasing utilization (e.g. from 40 to 80) has the effect of increasing max sync rate by
     2x.</p>
   </li>
  </ul>
  <p ixia_locid="147"> </p>
  <note id="note_N10386_N1001F_N10001" ixia_locid="149">
   <p ixia_locid="148">If the system is limited by disk performance (for example, if disk
    utilization is near 100%) the DRBD tunable parameters have no bearing on the effective sync
    rate. In addition, if there is other I/O activity in the system, DRBD self-regulates and the
    effective sync rate is reduced.</p>
  </note>
 </conbody>
</concept-wr>