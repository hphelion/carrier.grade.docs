<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="topic10581cgispp">
  <title>HPE Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 1.1: Applying the HLM Port Security
    Patch</title>
  <prolog>
    <metadata>
      <othermeta name="layout" content="default"/>
      <othermeta name="product-version" content="HPE Helion Openstack Carreir Grade 1.1"/>
      <othermeta name="role" content="Storage Administrator"/>
      <othermeta name="role" content="Storage Architect"/>
      <othermeta name="role" content="Michael B"/>
      <othermeta name="product-version1" content="HPE Helion Openstack Carreir Grade 1.1"/>
    </metadata>
  </prolog>
  <body>
    <p><!--Based on https://wiki.hpcloud.net/display/HCG/.Helion+CG+1.1+GA+Patch+Instructions--></p>
    <p>The HLM VM has all its ports open for inbound and outbound access after it has been deployed.
      The HLM ports must be open for inbound access from all the cloud nodes</p>
    <p>If security is a concern, all ports on HLM except for the standard ports like SSH, HTTP,
      HTTPS etc must be blocked for inbound access.</p>
    <p>This patch secures all ports on the HLM VM. The standard protocol ports will allow inbound
      access only and the only the cloud nodes will have inbound access to the other ports of the
      HLM VM.</p>
    <p>If your HPE Helion OpenStack Carrier Grade cloud is being used in a production environment, we
      recommend applying this patch. If your cloud is in a proof-of-concept (POC) environment, where
      external access is not a concern, this patch is not recommended and is not necessary.</p>
    <p>You should have downloaded the patch files in the <xref
        href="carrier-grade-install-pb-prereqs-GA.dita#topic7148/getinstall"
      >Prerequisites</xref>.</p>
    <p>Use the following steps to apply this patch:</p>
    <ol>
      <li>Log into the HLM host.</li>
      <li>Copy the <codeph>secure_HLM_ports_patch_1.1.tar.gz</codeph> file to the
          <codeph>~/patch_cghelion1.1</codeph> directory.
        <codeblock>cp secure_HLM_ports_patch_1.1.tar.gz ~/patch_cghelion1.1</codeblock></li>
      <li>Use the following command to extract the <codeph>random-password.tar.gz</codeph>:
        <codeblock>tar -zxvf secure_HLM_ports_patch_1.1.tar.gz</codeblock></li>
      <li>Copy the extracted the files:
        <codeblock>cp ~/patch_cghelion1.1/hlmiptables ~/&lt;cloudname&gt;/clouds/&lt;cloudname&gt;/001/stage/ansible/roles/
cp ~/patch_cghelion1.1/secureHLM.yml ~/&lt;cloudname&gt;/clouds/&lt;cloudname&gt;/001/stage/ansible/</codeblock></li>
      <li>Edit the
          <codeph>~/&lt;cloudname&gt;/clouds/&lt;cloudname&gt;/001/stage/ansible/group_vars/all</codeph>
        file to add the following varible before the line that contains <codeph>global</codeph>.
        Specify the cloud name in all capital letters:
          <codeblock>cloud_nodes_hostgroup: &lt;cloudname></codeblock><p>where &lt;cloudname> is the
          name of the cloud you created.</p><p><b>Example:</b> The first lines of your
            <codeph>group_vars/all</codeph> file should look like
        following:</p><codeblock># Cloud: ovs (ovs)
# Variables in this file are applicable to the "all" host group
cloud_nodes_hostgroup: OVS
global:
ansible_vars:
compute_virt_type: qemu
dns_address: 10.10.10.25
dns_domain_name: helion.cg
ext_dns_ip: 10.10.10.25
ssl_cert_file: /root/ovs/ca.crt
--------</codeblock></li>
      <li>Run following command:
        <codeblock>cd ~/&lt;cloudname&gt;/clouds/&lt;cloudname&gt;/001/stage/ansible/ansible-playbook -i hosts secureHLM.yml --ask-pass</codeblock></li>
      <li> Enter the password for the HLM root user (by default, <codeph>cghelion</codeph>) and hit
        enter.</li>
      <li>This should run the hlmiptables role which will secure all ports on HLM</li>
    </ol>
    <p>Return to the <xref href="carrier-grade-install-kvm.dita#topic10581cgik/patch-after">KVM
      installation</xref>.</p>
    <p/>
    </body>
</topic>
