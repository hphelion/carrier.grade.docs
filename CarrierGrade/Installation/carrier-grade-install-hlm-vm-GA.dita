<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" ><topic xml:lang="en-us" id="topic10581cgikvg">
<title>HPE Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 1.1: Installing the KVM + ESX<tm
      tmtype="reg"/> Deployment</title>
<prolog>
  <metadata>
    <othermeta name="layout" content="default"/>
    <othermeta name="product-version" content="HPE Helion Openstack Carreir Grade 1.1"/>
    <othermeta name="role" content="Storage Administrator"/>
    <othermeta name="role" content="Storage Architect"/>
    <othermeta name="role" content="Michael B"/>
    <othermeta name="product-version1" content="HPE Helion Openstack Carreir Grade 1.1"/>
  </metadata>
</prolog>
<body>
  <p>The first phase of the HPE Helion Openstack Carrier Grade installation involves creating a
      virtual machine for the Helion Lifecycle Management (HLM), deploying the HPE Helion OpenStack
      cloud, and installing DCN components. You must install the VMware ESX <tm tmtype="reg"
      />compute proxy.</p>
    <p>The installation uses Ansible playbooks, which are files that contain scripts that execute
      required installation processes.</p>
<section id="prereqs">
  <p>Before starting the HPE Helion OpenStack Carrier Grade installation, the VMware vSphere application and 
    HPE Distributed Cloud Networking components must be fully installed and functioning:</p>
<ul>
<li>ESXi requirements: 
  <ul><li>	vSphere Cluster running ESXi 5.5u2 with vMotion enabled.</li> 
    <li>1 Virtual Machine Port Group with all Cloud Vlans associated to the Port Group.</li></ul></li>
  
  <li>VRSvApp requirements <p>VRSvApp must be installed. Please Refer to the DCN VSP 3.0 R7
            installation Guide for VRSvApp installation.</p></li>
</ul>  
  
</section>
<section id="prepare"> <title>Prepare the system for deployment</title>
  <p>Use the following steps to prepare the server on which the HLM VM will be deployed (the lifecycle manager host):</p>
<ol>
  <li>Log into the lifecycle manager host using the default credentials</li>

  <li>Edit the <codeph>/root/infra-ansible-playbooks/group_vars/all</codeph> file for your
          environment. For information on each variable, refer to the comments in the file with each
          variable. <p>The <codeph>group_vars/all</codeph> file should appear similar to the
            following for a KVM + ESX
          deployment:</p><codeblock>
    ############################################# Variables for HLM  #################################################################
    #These variables are relevant in both All Virtual and BareMetal scenarios.
    
    #Set this to 1 if you will not deploy a dcn cloud via this HLM node and will deploy only ovs cloud
    ovs_cloud_only:  0
    
    #Set this to 'bm' if cloud is being deployed over baremetal.
    #Set this to 'av' if the cloud is all virtual
    cloud_type: 'bm'
    
    #These are hlm related variables that must be changed according to your Baremetal Env
    hlm_login_id:       root
    hlm_password:       cghelion
    
    #The following variables are for CLM network IP details for HLM
    hlm_clmstaticip:    10.20.x.x
    hlm_clmnetmask:     255.255.255.0
    hlm_clmgateway:     10.20.x.x
    
    #The variables starting with cobbler_ are inputs that are usually given to initcobbler.sh. Set accordingly.
    cobbler_pxestartip: 10.20.x.x
    cobbler_pxeendip:   10.20.x.x
    cobbler_pxestaticip: 10.20.x.x
    cobbler_pxenetmask: 255.255.255.0
    
    #Set the location of your images that will be used by libvirt
    imagelocation: /var/lib/libvirt/images
    
    #Set the location of your infra-ansible-playbooks
    ansible_dir: ~/infra-ansible-playbooks</codeblock></li>
  <li id="hosts">Check the <codeph>/root/infra-ansible-playbooks/hosts</codeph> file to enter the IP
          address of the <codeph>vibr0</codeph> interface in the <codeph>hlm_kvm_host</codeph>
          field, as shown in the following example. </li>
</ol>
<codeblock>  [hlm_kvm_host]
  192.168.122.1 </codeblock>
</section>
<section id="deploy-the-hlm-and-vsd-vm">
      <title>Deploy the HLM Virtual Machine</title>
  <p>Use the following steps on the lifecycle manager host to deploy the HLM VM on the lifecycle manager Host using Ansible
        playbooks.</p>
      <ol>
        <li>Execute the following command:<codeblock>ansible-playbook -i hosts setup_hlm_onBM.yml</codeblock><!-- The command will do the following:<ul><li>Copy both installation files (tar balls) to the HLM host, decrypt, and extract the files.</li><li>Execute the <codeph>updatepackages</codeph> command.</li><li>Execute the <codeph>prepareenv</codeph> command.</li><li>Execute the <codeph>Init cobbler</codeph> command.</li><li>Execute the <codeph>Importiso</codeph> command.<p>You will see a message similar to the following image when the playbook is run successful:</p></li></ul>-->
          <image href="../../media/CGH-ansible-playbook-run.png" id="image_bfp_pjm_vs">
            <alt>Sample Ansible Playbook run output</alt>
          </image></li>
        <li>Locate the IP address for the HLM VM in the
          <codeph>/root/infra-ansible-playbooks/group_vars/all</codeph> file of the lifecycle manager host under
            <codeph>hlm_clmstaticip</codeph> field. You will use this IP address to SSH into the HLM
          VM during the HPE Helion OpenStack Carrier Grade installation process.</li> 
      </ol>

</section>

  <section id="next-step">
      <title>Next Step</title>
      <p> </p>
    </section>
</body>
</topic>
