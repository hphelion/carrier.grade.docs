<?xml version="1.0" encoding="UTF-8"?><?workdir /C:\Drop3and4\Drop4\temp\pdf?><?workdir-uri file:/C:/Drop3and4/Drop4/temp/pdf/?><?path2project?><?path2project-uri ./?><task-wr xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" domains="(topic task task-wr)                            (topic hi-d)                            (topic pr-d)                            (topic sw-d)                            (topic ui-d)                            (topic wr-sw-d)                            (topic xml-d)   " id="psa1413402160578" xml:lang="en-us" ditaarch:DITAArchVersion="1.2" class="- topic/topic task/task task-wr/task-wr ">
<!-- Modification History
        
-->
    <title ixia_locid="1" class="- topic/title ">PCI Passthrough Ethernet Interfaces</title>
    <shortdesc ixia_locid="2" class="- topic/shortdesc ">A <term ixia_locid="3" class="- topic/term ">passthrough</term> Ethernet interface is a physical PCI Ethernet NIC on a
        compute node to which a virtual machine is granted direct access. This minimizes packet
        processing delays but at the same time demands special operational
        considerations.</shortdesc>
    <prolog class="- topic/prolog ">
        <author ixia_locid="148" class="- topic/author ">Jim Owens</author>
        <author ixia_locid="4" class="- topic/author ">Pedro Sanchez</author>
    </prolog>
    <taskbody class="- topic/body task/taskbody ">
        <context id="context_N10023_N10020_N10001" ixia_locid="5" class="- topic/section task/context ">
            <p ixia_locid="6" class="- topic/p ">For all purposes, a PCI passthrough interface behaves as if it were
                physically attached to the virtual machine. Therefore any potential throughput
                limitations coming from the virtualized environment, such as the ones introduced by
                internal copying of data buffers, are eliminated. However, by bypassing the
                virtualized environment, the use of PCI passthrough Ethernet devices introduces
                several restrictions that must be taken into consideration. They include:</p>
            <ul id="ul_mjs_m52_tp" class="- topic/ul ">
                <li ixia_locid="7" class="- topic/li ">
                    <p ixia_locid="8" class="- topic/p ">no support for LAG, QoS, ACL, or host interface monitoring</p>
                </li>
                <li ixia_locid="9" class="- topic/li ">
                    <p ixia_locid="10" class="- topic/p ">no support for live migration</p>
                </li>
                <li ixia_locid="11" class="- topic/li ">
                    <p ixia_locid="12" class="- topic/p ">no access to the compute node's AVS switch</p>
                </li>
            </ul>
            <p ixia_locid="14" class="- topic/p ">A passthrough interface bypasses the compute node's AVS switch
                completely, and is attached instead directly to the provider network's access
                switch. Therefore, proper routing of traffic to connect the passthrough interface to
                a particular tenant network depends entirely on the VLAN tagging options configured
                on both the passthrough interface and the access port on the switch.</p>
            <p ixia_locid="15" class="- topic/p ">The access switch routes incoming traffic based on a VLAN ID, which ultimately
                determines the tenant network to which the traffic belongs. The VLAN ID is either
                explicit, as found in incoming tagged packets, or implicit, as defined by the access
                port's default VLAN ID when the incoming packets are untagged. In both cases the
                access switch must be configured to process the proper VLAN ID, which therefore has
                to be known in advance.</p>
            <p ixia_locid="153" class="- topic/p ">To review the current PCI passthrough and SR-IOV device assignments
                for a given provider network, see <xref href="jow1439301559036.xml" ixia_locid="154" class="- topic/xref "/>.</p>
            <p ixia_locid="16" class="- topic/p ">In the following example a new virtual machine is launched by user
                    <nameliteral ixia_locid="17" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">user1</nameliteral> on tenant <nameliteral ixia_locid="18" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">tenant1</nameliteral>, with a passthrough interface connected to
                the tenant network <nameliteral ixia_locid="19" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">net0</nameliteral> identified with
                VLAN ID 10.</p>
        </context>
        <prereq id="prereq_N10065_N10020_N10001" ixia_locid="20" class="- topic/section task/prereq ">
            <note id="note_N10096_N10082_N10029_N10001" ixia_locid="156" class="- topic/note ">
                <p ixia_locid="157" class="- topic/p ">To use PCI passthrough or SR-IOV interfaces, you must have Intel
                    VT-d features enabled in the BIOS.</p>
            </note>
            <p ixia_locid="21" class="- topic/p ">The exercise assumes that the underlying provider network
                    <nameliteral ixia_locid="22" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">group0-data0</nameliteral> exists already, and that VLAN ID 10 is a
                valid segmentation ID assigned to <nameliteral ixia_locid="23" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">tenant1</nameliteral>.</p>
        </prereq>
        <steps class="- topic/ol task/steps ">
            <step id="step_N10079_N10076_N10020_N10001" ixia_locid="24" class="- topic/li task/step ">
                <cmd ixia_locid="25" class="- topic/ph task/cmd ">Log in as the <nameliteral ixia_locid="26" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">admin</nameliteral> user to the web management
                    interface.</cmd>
            </step>
            <step id="step_N1009B_N10088_N10024_N10001" ixia_locid="116" class="- topic/li task/step ">
                <cmd ixia_locid="117" class="- topic/ph task/cmd ">Lock the compute node you want to configure.</cmd>
            </step>
            <step id="step_N10086_N10076_N10020_N10001" ixia_locid="27" class="- topic/li task/step ">
                <cmd ixia_locid="28" class="- topic/ph task/cmd ">Configure the Ethernet interface to be used as a PCI
                    passthrough interface.</cmd>
                <info ixia_locid="118" class="- topic/itemgroup task/info ">
                    <p ixia_locid="119" class="- topic/p ">Select the <wintitle ixia_locid="31" class="+ topic/keyword ui-d/wintitle ">System
                            Inventory</wintitle> window from the <uicontrol ixia_locid="32" class="+ topic/ph ui-d/uicontrol ">Admin</uicontrol> panel, click the <uicontrol ixia_locid="33" class="+ topic/ph ui-d/uicontrol ">Hosts</uicontrol> tab, click the name of the compute node where the PCI
                        interface is available, click the <uicontrol ixia_locid="34" class="+ topic/ph ui-d/uicontrol ">Interfaces</uicontrol> tab, and finally click the <uicontrol ixia_locid="36" class="+ topic/ph ui-d/uicontrol ">Edit Interface</uicontrol> button associated with the
                        interface you want to configure. Fill in the window as illustrated
                        below:</p>
                    <fig id="fig_hfk_cfh_rr" ixia_locid="120" class="- topic/fig ">
                        <image href="psa1428772332800.image" id="image_whc_5kh_rr" ixia_locid="122" placement="inline" class="- topic/image ">
                            <alt ixia_locid="123" class="- topic/alt ">TiS Edit PCI Passthrough Interface</alt>
                        </image>
                    </fig>
                    <p ixia_locid="124" class="- topic/p ">In this example, Ethernet interface <nameliteral ixia_locid="42" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">eth8</nameliteral> is assigned the network type <term ixia_locid="43" class="- topic/term ">pci-passthrough</term>, and configured as connected to provider network
                            <nameliteral ixia_locid="44" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">group0-data0</nameliteral>. Click the
                            <uicontrol ixia_locid="45" class="+ topic/ph ui-d/uicontrol ">Save</uicontrol> button to proceed.</p>
                    <p ixia_locid="46" class="- topic/p ">The interface can also be configured from the CLI as
                        illustrated below:</p>
                    <codeblock ixia_locid="108" class="+ topic/pre pr-d/codeblock "><systemoutput ixia_locid="111" class="+ topic/ph sw-d/systemoutput ">~(keystone_admin)$ </systemoutput><userinput ixia_locid="115" class="+ topic/ph sw-d/userinput ">system host-if-modify \
-nt pci-passthrough -p group0-data0 compute-0 eth8</userinput></codeblock>
                </info>
            </step>
            <step id="step_N100E9_N10076_N10020_N10001" ixia_locid="51" class="- topic/li task/step ">
                <cmd ixia_locid="52" class="- topic/ph task/cmd ">Create the <nameliteral ixia_locid="53" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">net0</nameliteral>
                    tenant network</cmd>
                <info ixia_locid="54" class="- topic/itemgroup task/info ">
                    <p ixia_locid="55" class="- topic/p ">Select the <wintitle ixia_locid="56" class="+ topic/keyword ui-d/wintitle ">Networks</wintitle>
                        window from the <uicontrol ixia_locid="57" class="+ topic/ph ui-d/uicontrol ">Admin</uicontrol> panel, click
                        the <uicontrol ixia_locid="58" class="+ topic/ph ui-d/uicontrol ">Networks</uicontrol> tab, and then click the
                            <uicontrol ixia_locid="59" class="+ topic/ph ui-d/uicontrol ">Create Network</uicontrol> button. Fill in
                        the <wintitle ixia_locid="60" class="+ topic/keyword ui-d/wintitle ">Create Network</wintitle> window as
                        illustrated below. You must ensure that:</p>
                    <ul id="ul_pcn_vb4_tp" class="- topic/ul ">
                        <li ixia_locid="61" class="- topic/li ">
                            <p ixia_locid="62" class="- topic/p ">The <nameliteral ixia_locid="63" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">tenant1</nameliteral> tenant has access to the tenant network,
                                either assigning it as the owner, as in the illustration (using
                                    <uicontrol ixia_locid="107" class="+ topic/ph ui-d/uicontrol ">Project</uicontrol>), or by enabling the shared
                                flag.</p>
                        </li>
                        <li ixia_locid="64" class="- topic/li ">
                            <p ixia_locid="65" class="- topic/p ">The segmentation ID is set to 10. </p>
                        </li>
                    </ul>
                    <fig id="fig_kwr_hd4_tp" ixia_locid="66" class="- topic/fig ">
                        <image href="psa1413406273455.image" id="image_ofd_kd4_tp" ixia_locid="67" placement="inline" class="- topic/image ">
                            <alt ixia_locid="68" class="- topic/alt ">Creating a tenant network for use with PCI
                                passthrough devices</alt>
                        </image>
                    </fig>
                    <p ixia_locid="69" class="- topic/p ">Click the <uicontrol ixia_locid="70" class="+ topic/ph ui-d/uicontrol ">Create Network</uicontrol> button to proceed.</p>
                </info>
            </step>
            <step id="step_N10144_N10076_N10020_N10001" ixia_locid="71" class="- topic/li task/step ">
                <cmd ixia_locid="72" class="- topic/ph task/cmd ">Configure the access switch.</cmd>
                <info ixia_locid="73" class="- topic/itemgroup task/info ">
                    <p ixia_locid="104" class="- topic/p ">Configure the physical port on the access switch used to
                        connect to Ethernet interface <nameliteral ixia_locid="75" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">eth8</nameliteral> as an access port with default VLAN ID of 10.
                        Traffic across the connection is therefore untagged, and effectively
                        integrated into the targeted tenant network.</p>
                    <p ixia_locid="76" class="- topic/p ">You can also use a trunk port on the access switch so that it
                        handles tagged packets as well. However, this opens the possibility for
                        guest applications to join other tenant networks using tagged packets with
                        different VLAN IDs, which might compromise the security of the system. See
                            <xref href="jow1404333739778.xml" ixia_locid="143" class="- topic/xref "/> for other details regarding the
                        configuration of the access switch.</p>
                </info>
            </step>
            <step id="step_N101A0_N10088_N10024_N10001" ixia_locid="125" class="- topic/li task/step ">
                <cmd ixia_locid="126" class="- topic/ph task/cmd ">Unlock the compute node.</cmd>
            </step>
            <step id="step_N1015D_N10076_N10020_N10001" ixia_locid="77" class="- topic/li task/step ">
                <cmd ixia_locid="78" class="- topic/ph task/cmd ">Launch the virtual machine.</cmd>
                <substeps id="substeps_snp_klt_tp" class="- topic/ol task/substeps ">
                    <substep ixia_locid="79" class="- topic/li task/substep ">
                        <cmd ixia_locid="80" class="- topic/ph task/cmd ">Log in as user <nameliteral ixia_locid="81" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">user1</nameliteral> to the web management
                            interface.</cmd>
                    </substep>
                    <substep ixia_locid="82" class="- topic/li task/substep ">
                        <cmd ixia_locid="83" class="- topic/ph task/cmd ">Configure the network interfaces for the new virtual machine.</cmd>
                        <info ixia_locid="84" class="- topic/itemgroup task/info ">
                            <p ixia_locid="85" class="- topic/p ">Open the <wintitle ixia_locid="86" class="+ topic/keyword ui-d/wintitle ">Launch
                                    Instance</wintitle> dialog by clicking the <uicontrol ixia_locid="87" class="+ topic/ph ui-d/uicontrol ">Launch Interface</uicontrol> button on the
                                    <wintitle ixia_locid="88" class="+ topic/keyword ui-d/wintitle ">Instances</wintitle> window. Configure
                                the necessary options for the new virtual machine. In particular,
                                click the <uicontrol ixia_locid="89" class="+ topic/ph ui-d/uicontrol ">Networking</uicontrol> tab and
                                add a PCI passthrough interface on the tenant network <nameliteral ixia_locid="90" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">net0</nameliteral>, as illustrated below. Add
                                other network interfaces as needed.</p>
                            <fig id="fig_yxy_t1g_tp" ixia_locid="91" class="- topic/fig ">
                                <image href="psa1413311389905.image" id="image_dbb_4dg_tp" ixia_locid="93" placement="inline" width="5.5in" class="- topic/image ">
                                    <alt ixia_locid="94" class="- topic/alt ">Assigning Passthrough PCI Ethernet
                                        Devices</alt>
                                </image>
                            </fig>
                            <p ixia_locid="95" class="- topic/p ">Click the <uicontrol ixia_locid="96" class="+ topic/ph ui-d/uicontrol ">Launch</uicontrol> button to proceed.</p>
                            <p ixia_locid="97" class="- topic/p ">Passthrough interfaces can be attached from the CLI when booting a
                                new virtual machine, as illustrated below:</p>
                            <codeblock ixia_locid="98" class="+ topic/pre pr-d/codeblock "><systemoutput ixia_locid="114" class="+ topic/ph sw-d/systemoutput ">~(keystone_admin)$ </systemoutput><userinput ixia_locid="100" class="+ topic/ph sw-d/userinput ">nova boot \
--nic net-id=704e9f3b,vif-model=pci-passthrough \
--flavor small --image cgcs-guest my-new-vm</userinput></codeblock>
                            <note id="note_N10230_N101DF_N101D6_N101C3_N101B9_N1008C_N10028_N10001" ixia_locid="149" class="- topic/note ">
                                <p ixia_locid="150" class="- topic/p ">By default, a VM that requires a PCI passthrough
                                    interface is instantiated only if a host NUMA node with a
                                    directly attached PCI interface is available. You can specify
                                    best-effort instantiation by using an extra specification. For
                                    more information, see <xref href="jow1436197980621.xml" ixia_locid="151" class="- topic/xref "/>.</p>
                            </note>
                        </info>
                    </substep>
                </substeps>
            </step>
        </steps>
        <result id="result_N101C1_N10020_N10001" ixia_locid="101" class="- topic/section task/result ">
            <p ixia_locid="102" class="- topic/p ">The new virtual machine instance is up now. It has a PCI passthrough
                connection to the <nameliteral ixia_locid="103" class="+ topic/ph hi-d/b wr-sw-d/nameliteral ">net0</nameliteral> tenant network
                identified with VLAN ID 10.</p>
        </result>
        <postreq id="postreq_N10262_N10029_N10001" ixia_locid="155" class="- topic/section task/postreq " conref="jow1439307476374.xml#jow1439307476374/postreq_N1023B_N10024_N10001"/>
    </taskbody>
</task-wr>